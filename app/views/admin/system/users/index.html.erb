<div class="pull-right">
  <%= select_tag :role_id, options_from_collection_for_select(Role.all, :id, :name, params[:role_id]), prompt: 'All roles'%> &nbsp; 
  <%= select_tag :status, options_for_select(User.uniq(:status).pluck(:status), params[:status]), prompt: 'Any status'%> &nbsp; 
  <%= link_to new_admin_system_user_path, class: 'btn btn-sm btn-default' do %>
    <i class="fa fa-plus"></i> New user
  <% end %>
</div>

<h2><i class="fa fa-user"></i> <%= current_domain %> Users</h2>


<%= render "admin/shared/search_results_header", object: @users %>


<%= will_paginate @users %>
<table class="table table-striped table-condensed">
	<tr>
    <th><%= sortable "core_users.id", "ID" %></th>
		<th><%= sortable "core_users.name", "Name" %></th>
		<th><%= sortable "email" %></th>
		<th><%= sortable "core_roles.name", "Role" %></th>
		<th><%= sortable "core_users.created_at", "Created" %></th>
    <th><%= sortable "status" %></th>
		<th class="actions">&nbsp;</th>
	</tr>
	<% @users.each do |user| %>
	<tr>
    <td><%= user.id %></td>
		<td><%= link_to user.name, admin_system_user_path(user) %></td>
		<td><%= user.email %>
		<td><%= user.role.name %></td>
		<td><%= systime user.created_at %></td>
    <td><%= user.status %></td>
		<td class="actions">
			<%= link_to "edit", edit_admin_system_user_path(user) %> &nbsp;
			<%= link_to "delete", 
						  { action: "destroy", id: user.id }, 
						  method: :delete, 
						  data: { confirm: "Are you sure?" } %>
		</td>
	</tr>
	<% end %>
</table>

<%= render 'admin/shared/table_summary', data: @users %>



<% content_for :title do %>
	Users
<% end %>

<% content_for :head do %>
  <script>
    $(document).ready(function() {
      $("#role_id, #status").change(function() {
        window.location = "/admin/system/users?role_id=" + $("#role_id").val() + "&status=" + $("#status").val();
      });
    });
  </script>
<% end %>


<% content_for :breadcrumbs do %>
	<li><a href="#">System</a></li>
	<li class="active">Users</li>
<% end %>